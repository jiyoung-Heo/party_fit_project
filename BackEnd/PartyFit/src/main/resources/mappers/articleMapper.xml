<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.partyfit.model.dao.ArticleDao">
	<select id="selectArticle" parameterType="map">
		select article_id, title, content, reg_date, mod_date, view_count, category,
		user_id, party_id from article
		where category = #{category} and
		party_id = #{partyId}
		<if test="condition.key != null">
			and ${condition.key} like
			concat('%',#{condition.word},'%')
		</if>
		<if test="condition.orderBy != null">
			order by ${condition.orderBy} ${condition.orderByDir}
		</if>
	</select>
	<insert id="insertArticle" parameterType="Article">
		insert into
		article(title, content, category, user_id, party_id) 
		values(#{title}, #{content}, #{category}, #{userId}, #{partyId})
	</insert>
	<update id="updateArticle" parameterType="Article">
		update article set
		title = #{title}, content = #{content}, mod_date = now(), user_id = #{userId}, party_id =#{partyId}
		where article_id = #{articleId}
	</update>
	<delete id="deleteArticle" parameterType="int">
		delete from article where article_id = #{articleId}
	</delete>
	<select id="selectAtricleDetail" parameterType="int" resultType="ArticleUser">
		select a.*, u.*
		from article a, user u 
		where article_id = #{articleId} and a.user_id = u.user_id
	</select>
	<update id="updateArticleViewCount" parameterType="int">
		update article set view_count = view_count +1 where article_id = #{articleId}
	</update>
	<select id="selectMyArticle" parameterType="User" resultType="Article">
		select * from article where user_id=#{userId}
	
	</select>
	
</mapper>